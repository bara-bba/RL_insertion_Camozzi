<?xml version="1.0" encoding="utf-8"?>

<mujoco model="gripper_position">

	<!-- SET MUJOCO PARAMETERS -->
    <compiler angle="radian" coordinate="local" meshdir="./stl/robotiq" balanceinertia="true"></compiler>

	<!-- SET CLASSES DEFAULTS-->
	<default class="main">

		<geom condim="3"/>

		<default class="gripper">
			<joint frictionloss="1" damping="1000" />
		</default>

		<default class="finger">
			<joint frictionloss="1" damping="1" />
		</default>

		<default class="component">
			<geom friction="0.4 0.4 0.4"></geom>
		</default>

	</default>

	<visual>
		<scale framewidth="0.05" framelength="0.8" jointwidth="0.05" jointlength="0.8" actuatorwidth="0.05" actuatorlength="0.8" forcewidth="0.1" contactwidth="0.1"/>
	</visual>

	<!-- SET MESHES -->
	<asset>
		<mesh file="base.stl" />
        <mesh file="shoulder.stl" />
        <mesh file="upperarm.stl" />
        <mesh file="forearm.stl" />
        <mesh file="wrist1.stl" />
        <mesh file="wrist2.stl" />
        <mesh file="wrist3.stl" />
        <mesh file="kinova_robotiq_coupler.stl" />
        <mesh file="robotiq_85_base_link.stl" />
        <mesh file="robotiq_85_finger_link.stl" />
        <mesh file="robotiq_85_finger_tip_link.stl" />
        <mesh file="robotiq_85_inner_knuckle_link.stl" />
        <mesh file="robotiq_85_knuckle_link.stl" />
        <material name="RobMat" specular="0.9" shininess="0.5" reflectance="0" rgba="0.7 0.7 0.7 1" emission="0.1" />
        <material name="GriMat" specular="0.9" shininess="0.5" reflectance="0" rgba="0.1 0.1 0.1 1" emission="0.1" />
        <material name="BasketMat" specular="0" shininess="0" reflectance="0" rgba="0.26 0.16 0.16796875 1" emission="0" />
        <material name="Light" specular="0" shininess="0.6" reflectance="0.9" rgba="0.5 0.5 1 1" emission="0.7" />
	</asset>

	<!-- SET BODIES PARAMETERS -->
	<worldbody>

		<!-- FLOOR -->
		<geom name="floor" type="plane" pos="0. 0. 0." size="3.3 3.3 0.5" rgba="1. 1. 0 1" contype="1" conaffinity="1"/>

		<!-- TABLE -->
		<body name="wrk_table" pos="0 0 0.2" mocap="true">
			<geom type="box" mass="90" size=".2 .2 .2" rgba="0 0 0 1" contype="1" conaffinity="1"/>
		</body>

		<!--  HOLE  -->
		<body name="wrk_hole" pos="0 0 .45" mocap="true">
			<geom pos="-.035 0 0" size="0.008 0.05 0.05" type="box" group="1"/>
			<geom pos=".035 0 0" size="0.008 0.05 0.05" type="box" group="1"/>
			<geom pos="0 -.035 0" size="0.05 0.008 0.05" type="box" group="1"/>
			<geom pos="0 .035 0" size="0.05 0.008 0.05" type="box" group="1"/>
		</body>

		<!-- COMPONENT -->
		<body childclass="component" name="component" pos="0 0.1 .6">
			<geom name="component" pos="0 0 0" size="0.025 0.025 0.025" type="box" rgba="0.9529411765 0.8 0.03529411765 1" />
			<site name="component_site" pos="0 0 0" size="0.025 0.025 0.025" type="box" rgba="0.9529411765 0.8 0.03529411765 1" />
            <joint name="free_x" pos="0 0 0" type="slide" axis="1 0 0" frictionloss="0" damping="0" />
            <joint name="free_y" pos="0 0 0" type="slide" axis="0 1 0" frictionloss="0" damping="0" />
            <joint name="free_z" pos="0 0 0" type="slide" axis="0 0 1" frictionloss="0" damping="0" />
            <joint name="free_ball" pos="0 0 0" type="ball" frictionloss="0" damping="0" />
		</body>

		<!--  TARGET  -->
		<body name="target" pos="0 0 .45" mocap="true">
			<geom type="box" size=".03 .03 .05" rgba=".9 0 0 .5" contype="8" conaffinity="8"/>
		</body>

		<!--  SITE TO BUILD -->
		<site name="target" pos="0 0 .4" rgba="1 1 1 1"/>
		<site pos="0 0 0" rgba="1 1 1 1"/>

		<!-- GRIPPER -->
		<body childclass="gripper" name="ee_link" pos="0 0.1 0.8" euler="3.14159265359 0 0">

			<inertial pos="0 0.0823 0" quat="1 0 0 0" mass="0.1" diaginertia="0 1 0" />

			<joint type="slide" name="posX" axis="1 0 0" range="-1 1"/>
			<joint type="slide" name="posY" axis="0 1 0" range="-1 1"/>
			<joint type="slide" name="posZ" axis="0 0 1" range="-1 1"/>
			<joint type="ball" name="wrist" range="0 1.57079632679"/>

			<camera name="gripper_camera" euler="0 3.14159265 0" fovy="63.5" />
			<geom name="light_1" type="sphere" size="0.005" pos="0.035 0 0.0166" material="Light" />
			<geom name="light_2" type="sphere" size="0.005" pos="-0.035 0 0.0166" material="Light" />
			<geom name="kinova_robotiq_coupler_mesh" type="mesh" mesh="kinova_robotiq_coupler" pos="0 0 0.0466" material="GriMat" />
			<geom name="robotiq_85_base_link_mesh" type="mesh" mesh="robotiq_85_base_link" pos="0 0 0.0016" quat="0.707107 0 -0.707107 0" material="GriMat" />

			<body childclass="finger" name="right_driver" pos="0 -0.0306011 0.054904" quat="0.707107 0 -0.707107 0">
				<geom name="right_driver_mesh" type="mesh" mesh="robotiq_85_knuckle_link" material="GriMat" contype="0" conaffinity="0" />
				<joint name="joint7_1" axis="0 0 1" type="hinge" limited="true" range="0 0.872664626" />


				<body childclass="finger" name="right_coupler" pos="0 -0.0315 0">
					<geom name="right_coupler_mesh" type="mesh" mesh="robotiq_85_finger_link" material="GriMat" contype="0" conaffinity="0" />
					<joint name="joint8_1" axis="0 0 1" type="hinge" limited="true" range="0 2.967059728" />

					<body childclass="finger" name="right_follower_link" pos="0.0475 -0.006 0">
						<geom name="right_follower_mesh" pos="0.0025 0.021 0" type="mesh" mesh="robotiq_85_finger_tip_link" material="GriMat" />
						<joint name="joint9_1" axis="0 0 1" type="hinge" limited="true" range="0 2.967059728" />
					</body>

				</body>

			</body>

			<body childclass="finger" name="right_spring_link" pos="0.0016 -0.012 0.0614" quat="0.707107 0 -0.707107 0">
				<geom name="right_spring_mesh" type="mesh" pos="0 -0.0005 0.0016" mesh="robotiq_85_inner_knuckle_link" material="GriMat" contype="0" conaffinity="0" />
				<joint name="joint10_1" axis="0 0 1" type="hinge" limited="true" range="0 1" />
			</body>


			<body childclass="finger" name="left_driver" pos="0 0.0306011 0.054904" quat="0 0.707107 0 0.707107">
				<geom name="left_driver_mesh" type="mesh" mesh="robotiq_85_knuckle_link" material="GriMat" contype="0" conaffinity="0" />
				<joint name="joint7_2" axis="0 0 1" type="hinge" limited="true" range="0 0.872664626" />


				<body childclass="finger" name="left_coupler" pos="0 -0.0315 0">
					<geom name="left_coupler_mesh" type="mesh" mesh="robotiq_85_finger_link" material="GriMat" contype="0" conaffinity="0" />
					<joint name="joint8_2" axis="0 0 1" type="hinge" limited="true" range="0 2.967059728" />

					<body childclass="finger" name="left_follower_link" pos="0.0475 -0.006 0">
						<geom name="left_follower_mesh" pos="0.0025 0.021 0" type="mesh" mesh="robotiq_85_finger_tip_link" material="GriMat" />
						<joint name="joint9_2" axis="0 0 1" type="hinge" limited="true" range="0 2.967059728" />
					</body>

				</body>

			</body>

			<body childclass="finger" name="left_spring_link" pos="0.0016 0.012 0.0614" quat="0 0.707107 0 0.707107">
				<geom name="left_spring_mesh" type="mesh" pos="0 0.0005 0.0016" mesh="robotiq_85_inner_knuckle_link" material="GriMat" contype="0" conaffinity="0" />
				<joint name="joint10_2" axis="0 0 1" type="hinge" limited="true" range="0 1" />
			</body>
		</body>

	</worldbody>

	<equality>
        <joint name="right_1" joint1="joint7_1" joint2="joint9_1" polycoef="0 -2.933333 0 0 0" />
        <joint name="left_1" joint1="joint7_2" joint2="joint9_2" polycoef="0 -100 0 0 0" />
    </equality>

    <actuator>
		<motor name="close_l" joint="joint7_2" gear="10 0 0 0 0 0" />
		<motor name="close_r" joint="joint7_1" gear="10 0 0 0 0 0" />

		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="posX" kp="10000" name="posX"></position>
		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="posY" kp="10000" name="posY"></position>
		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="posZ" kp="10000" name="posZ"></position>

		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="wrist" kp="10000" name="wrist1" gear="1 0 0"></position>
		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="wrist" kp="10000" name="wrist2" gear="0 1 0"></position>
		<position ctrllimited="true" ctrlrange="-0.52399 .523599" joint="wrist" kp="10000" name="wrist3" gear="0 0 1"></position>

		<!--motor ctrllimited="true" ctrlrange="-1 1" joint="l_gripper_finger_joint" gear="1000" name="l_gripper_finger_joint" user="1"></motor>
		<motor ctrllimited="true" ctrlrange="-1 1" joint="r_gripper_finger_joint" gear="1000" name="r_gripper_finger_joint" user="1"></motor>-->
	</actuator>

</mujoco>